<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MKT4X VIRTUAL | Official Portal</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root{
    --mint-primary:#A8E6CF;
    --mint-soft:#E8FFF8;
    --mint-accent:#5CD6C0;
    --mint-dark:#2F4F4F;
    --mint-deep:#1F3A3A;
    --white:#ffffff;
    --shadow:rgba(92,214,192,0.3);
}
*{box-sizing:border-box;}
body{
    margin:0;
    background:linear-gradient(180deg,#E8FFF8 0%,#ffffff 100%);
    color:var(--mint-dark);
    font-family:'Inter',sans-serif;
    overflow-x:hidden;
}
/* NAVBAR */
.navbar{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:15px 5%;
    background:var(--white);
    box-shadow:0 5px 20px var(--shadow);
    position:sticky;
    top:0;
    z-index:1000;
    height:70px;
}
.logo{
    display:flex;
    align-items:center;
}
.logo img{
    height:32px;
    width:auto;
    object-fit:contain;
    display:block;
}
@media (max-width:768px){
    .navbar{ height:60px; }
    .logo img{ height:24px; }
}
/* RIGHT NAV */
.nav-right{
    display:flex;
    align-items:center;
    gap:20px;
}
.lang-container{
    display:flex;
    align-items:center;
    gap:5px;
    cursor:pointer;
}
.lang-container i{
    color:var(--mint-accent);
}
select{
    background:transparent;
    color:var(--mint-dark);
    border:none;
    outline:none;
    font-size:0.85rem;
    cursor:pointer;
}
/* MENU BUTTON */
.menu-btn{
    cursor:pointer;
    display:flex;
    flex-direction:column;
    gap:4px;
    z-index:10001;
}
.menu-btn span{
    width:22px;
    height:2px;
    background:var(--mint-dark);
    transition:0.3s;
}
/* SIDEBAR */
.sidebar{
    position:fixed;
    top:0;
    right:-280px;
    width:280px;
    height:100vh;
    background:var(--white);
    border-left:2px solid var(--mint-primary);
    transition:0.3s ease;
    z-index:9999;
    padding:80px 30px;
    box-shadow:-10px 0 30px var(--shadow);
}
.sidebar.active{ right:0; }
.sidebar ul{
    list-style:none;
    padding:0;
}
.sidebar ul li{
    margin-bottom:25px;
}
.sidebar ul li a{
    color:var(--mint-dark);
    text-decoration:none;
    font-size:1rem;
    display:flex;
    align-items:center;
    gap:15px;
    transition:0.2s;
}
.sidebar ul li a:hover{
    color:var(--mint-accent);
    transform:translateX(5px);
}
.reg-link{
    color:var(--mint-accent) !important;
    font-weight:bold;
}
/* SIDEBAR LOGO */
.sidebar-logo{
    display:flex;
    justify-content:center;
    align-items:center;
    margin-bottom:30px;
}
.sidebar-logo img{
    width:130px;
    height:auto;
    object-fit:contain;
}
/* OVERLAY */
.overlay{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:rgba(168,230,207,0.4);
    backdrop-filter:blur(4px);
    display:none;
    z-index:9998;
}
.overlay.active{ display:block; }
/* CONTENT */
.container{ padding:25px 5%; }
.video-box{
    width:100%;
    border-radius:20px;
    overflow:hidden;
    border:2px solid var(--mint-primary);
    margin-bottom:25px;
    box-shadow:0 10px 25px var(--shadow);
}
iframe{
    width:100%;
    aspect-ratio:16/9;
    display:block;
    border:none;
}
.card{
    background:var(--white);
    border-radius:18px;
    padding:18px;
    border:2px solid var(--mint-primary);
    margin-bottom:18px;
    box-shadow:0 8px 20px var(--shadow);
    transition:0.3s;
}
.card:hover{ transform:translateY(-5px); }
.card-title{
    font-size:0.8rem;
    font-weight:bold;
    color:var(--mint-accent);
    margin-bottom:10px;
    border-left:4px solid var(--mint-primary);
    padding-left:8px;
    letter-spacing:1px;
}

/* ===================== */
/* AUTH MODAL */
#authModal{
    display:none;
    position:fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.5);
    z-index:10000;
    justify-content:center;
    align-items:center;
}
#authModal div{
    background:white;
    padding:20px;
    border-radius:15px;
    max-width:400px;
    width:90%;
    display:flex;
    flex-direction:column;
}
#authModal input{
    margin-bottom:10px;
    padding:10px;
    border:1px solid #ccc;
    border-radius:8px;
    font-size:0.9rem;
}
#authModal button{
    padding:10px;
    border:none;
    border-radius:8px;
    font-size:0.9rem;
    cursor:pointer;
}
#authModal button.google{
    background:#4285F4; color:white;
}
#authModal button.close{
    background:#ccc;
    margin-top:10px;
}

/* PROFILE DISPLAY */
#profileContainer{
    display:none;
    margin-top:20px;
    text-align:center;
}
#profileContainer img{
    width:60px;
    height:60px;
    border-radius:50%;
    object-fit:cover;
    display:block;
    margin:0 auto 5px auto;
}
#profileContainer p{
    font-size:0.85rem;
    color:#5CD6C0;
}
#profileContainer button{
    padding:5px 10px;
    border:none;
    border-radius:5px;
    background:#5CD6C0;
    color:white;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<nav class="navbar">
    <div class="logo">
        <img src="https://i.imgur.com/yq2JRbl.png" alt="MKT4X Logo">
    </div>
    <div class="nav-right">
        <div class="lang-container">
            <i class="fas fa-globe"></i>
            <select id="langSelect">
                <option value="id">Indonesia</option>
                <option value="en">English</option>
                <option value="jp">Japanese</option>
                <option value="my">Melayu</option>
            </select>
        </div>
        <div class="menu-btn" onclick="toggleMenu()">
            <span></span><span></span><span></span>
        </div>
    </div>
</nav>

<div class="sidebar" id="sidebar">
    <div class="sidebar-logo">
        <img src="https://i.imgur.com/yq2JRbl.png" alt="MKT4X Logo">
    </div>
    <ul id="menuList">
        <li><a href="#"><i class="fas fa-newspaper"></i> <span>Berita</span></a></li>
        <li><a href="#"><i class="fas fa-calendar-alt"></i> <span>Jadwal</span></a></li>
        <li><a href="#"><i class="fas fa-users"></i> <span>Member</span></a></li>
        <li><a href="#"><i class="fas fa-microphone"></i> <span>Setlist</span></a></li>
        <hr style="opacity:0.1; margin:20px 0;">
        <li><a href="#" class="reg-link"><i class="fas fa-heart"></i> <span>Fanclub</span></a></li>
        <li>
            <a href="#" id="authBtn">
                <i class="fas fa-sign-in-alt"></i>
                <span id="authText">Masuk / Daftar</span>
            </a>
        </li>
    </ul>

    <!-- PROFILE DISPLAY -->
    <div id="profileContainer">
        <img id="profilePic" src="" alt="Profil">
        <p id="profileName"></p>
        <button onclick="editProfile()">Edit Profil</button>
    </div>
</div>

<main class="container">
    <div class="video-box">
        <iframe src="https://www.youtube.com/embed/8TSaCD7UynE"></iframe>
    </div>
    <div class="card">
        <div class="card-title" id="newsTitle">BERITA TERBARU</div>
        <div style="font-size:0.85rem;">
            <span style="color:#666;">2026.02.28</span>
            <p style="margin:5px 0;">MKT4X Virtual First Gen Audition is Open!</p>
        </div>
    </div>
    <div class="card">
        <div class="card-title" id="bdayTitle">ULANG TAHUN</div>
        <p style="font-size:0.85rem; color:#888;">Coming Soon</p>
    </div>
</main>

<!-- AUTH MODAL -->
<div id="authModal">
  <div>
    <h2 style="text-align:center; color:#5CD6C0;">Buat Akun / Login</h2>
    <input type="text" id="name" placeholder="Nama Lengkap">
    <input type="text" id="username" placeholder="Username">
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Password">
    <button id="registerBtn">Register</button>
    <button id="googleLoginBtn" class="google">Login dengan Google</button>
    <button id="closeModal" class="close">Tutup</button>
  </div>
</div>

<script type="module">
// ===================== FIREBASE =====================
import { auth, db } from "./firebase.js";
import {
  createUserWithEmailAndPassword,
  GoogleAuthProvider,
  signInWithPopup,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/12.10.0/firebase-auth.js";
import { doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.10.0/firebase-firestore.js";

// UI Elements
const authBtn = document.getElementById("authBtn");
const authText = document.getElementById("authText");
const userName = document.getElementById("profileName");
const userPic = document.getElementById("profilePic");
const profileContainer = document.getElementById("profileContainer");
const authModal = document.getElementById("authModal");
const registerBtn = document.getElementById("registerBtn");
const googleLoginBtn = document.getElementById("googleLoginBtn");
const closeModalBtn = document.getElementById("closeModal");

// ===================== FUNCTIONS =====================

// Toggle Auth Modal
authBtn.addEventListener("click", (e)=>{
  e.preventDefault();
  authModal.style.display = "flex";
});
closeModalBtn.addEventListener("click", ()=> authModal.style.display = "none");

// Register User
async function registerUser(name, username, email, password){
  try{
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    await setDoc(doc(db, "users", userCredential.user.uid), {
      name, username, email, role:"member", createdAt: new Date()
    });
    alert("Akun berhasil dibuat!");
  }catch(err){
    alert("Error: "+err.message);
  }
}

// Google Login
async function googleLogin(){
  const provider = new GoogleAuthProvider();
  try{
    const result = await signInWithPopup(auth, provider);
    const user = result.user;
    const docRef = doc(db,"users",user.uid);
    const docSnap = await getDoc(docRef);
    if(!docSnap.exists()){
      await setDoc(docRef,{
        name:user.displayName||"Google User",
        username:user.email.split("@")[0],
        email:user.email,
        role:"member",
        createdAt:new Date()
      });
    }
    alert("Login Google berhasil!");
  }catch(err){
    alert("Error: "+err.message);
  }
}

// Logout
async function logoutUser(){
  try{
    await signOut(auth);
  }catch(err){ console.error(err); }
}

// Register Button
registerBtn.addEventListener("click", async ()=>{
  const name = document.getElementById("name").value;
  const username = document.getElementById("username").value;
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  if(!name||!username||!email||!password) return alert("Isi semua field!");
  await registerUser(name, username, email, password);
  authModal.style.display="none";
});

// Google Button
googleLoginBtn.addEventListener("click", async ()=>{
  await googleLogin();
  authModal.style.display="none";
});

// Edit Profile
window.editProfile = async ()=>{
  const newName = prompt("Masukkan nama baru:", userName.innerText);
  if(newName){
    userName.innerText = newName;
    const user = auth.currentUser;
    if(user){
      await setDoc(doc(db,"users",user.uid), { name:newName }, { merge:true });
    }
    alert("Nama berhasil diperbarui!");
  }
};

// ===================== UPDATE UI =====================
onAuthStateChanged(auth, async (user)=>{
  if(user){
    authText.innerText="Logout";
    profileContainer.style.display="block";
    const docRef = doc(db,"users",user.uid);
    const docSnap = await getDoc(docRef);
    if(docSnap.exists()){
      userName.innerText = docSnap.data().name;
      userPic.src = "https://i.pravatar.cc/150?u="+user.uid;
    } else {
      userName.innerText = user.displayName||user.email;
      userPic.src = "https://i.pravatar.cc/150?u="+user.uid;
    }
    authBtn.onclick = logoutUser;
  }else{
    authText.innerText="Masuk / Daftar";
    profileContainer.style.display="none";
    authBtn.onclick = (e)=>{ e.preventDefault(); authModal.style.display="flex"; };
  }
});
</script>

</body>
</html>
